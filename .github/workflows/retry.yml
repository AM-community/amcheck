name: "Retry Apps Test"

on:
  workflow_run:
    workflows: ["apps: Test ðŸ’¯"]
    types:
      - completed

jobs:
  retry:
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    runs-on: ubuntu-latest
    steps:
      - name: "Trigger apps: Test ðŸ’¯ with retest_excluded"
        run: |
          curl -X POST \
           -H "Accept: application/vnd.github+json" \
           -H "Authorization: token $TOKEN" \
           -H "X-GitHub-Api-Version: 2022-11-28" \
           https://api.github.com/repos/ivan-hc/amcheck/actions/workflows/apps.yml/dispatches \
           -d '{"ref":"main","inputs":{"retest_excluded":"true"}}'
